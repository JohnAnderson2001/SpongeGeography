q()
q
q()
ls
q()
q
q()
version
help
q()
source("run.Rev")
mymcmc.run(generations=20000, tuningInterval=200)
mymcmc = mcmc(mymodel, monitors, moves, nruns=2, combine="mixed")
monitors.append( mnModel(filename="rb.log", printgen=10) )
source("run.Rev")
taxa <- readTaxonData("ages.tsv")
dna <- readDiscreteCharacterData("CombinedWithTaxonomySimplified.nex")
dna.addMissingTaxa( taxa )n_taxa <- taxa.size()moves = VectorMoves()
q()
taxa <- readTaxonData("ages.tsv")
dna <- readDiscreteCharacterData("CombinedWithTaxonomySimplified.nex")
dna.addMissingTaxa( taxa )
n_taxa <- taxa.size()
moves = VectorMoves()
source("cladeconstraints.Rev") # FBD tree prior
speciation_rate ~ dnExponential(10)
extinction_rate ~ dnExponential(10)
moves.append( mvScale(speciation_rate, lambda=0.01, weight=1) )
moves.append( mvScale(speciation_rate, lambda=0.1,  weight=1) )
moves.append( mvScale(speciation_rate, lambda=1.0,  weight=1) )
moves.append( mvScale(extinction_rate, lambda=0.01, weight=1) )
moves.append( mvScale(extinction_rate, lambda=0.1,  weight=1) )
moves.append( mvScale(extinction_rate, lambda=1,    weight=1) )
rho <- 0.001
psi ~ dnExponential(10) 
moves.append( mvScale(psi, lambda=0.01, weight=1) )
moves.append( mvScale(psi, lambda=0.1,  weight=1) )
moves.append( mvScale(psi, lambda=1,    weight=1) )
origin_time ~ dnUnif(530.0, 600.0)
moves.append( mvSlide(origin_time, delta=0.01, weight=5.0) )
moves.append( mvSlide(origin_time, delta=0.1,  weight=5.0) )
moves.append( mvSlide(origin_time, delta=1,    weight=5.0) )
fbd_dist = dnBDSTP(r=1, origin=origin_time, lambda=speciation_rate, mu=extinction_rate, psi=psi, rho=rho, taxa=taxa)
fbd_tree ~ dnConstrainedTopology(fbd_dist, constraints=constraints)
fbd_tree
moves.append( mvFNPR(fbd_tree, weight=15.0) )
moves.append( mvCollapseExpandFossilBranch(fbd_tree, origin_time, weight=6.0) )
moves.append( mvNodeTimeSlideUniform(fbd_tree, weight=40.0) )
moves.append( mvRootTimeSlideUniform(fbd_tree, origin_time, weight=5.0) )
fossils = fbd_tree.getFossils()
for(i in 1:fossils.size())
{
    t[i] := tmrca(fbd_tree, clade(fossils[i]))
    a_i = fossils[i].getMinAge()
    b_i = fossils[i].getMaxAge()
    F[i] ~ dnUniform(t[i] - b_i, t[i] - a_i)
    F[i].clamp( 0 )
}
moves.append( mvFossilTimeSlideUniform(fbd_tree, origin_time, weight=5.0) )
monitors.append( mnModel(filename="rb.log", printgen=10) )
monitors.append( mnModel(filename="output/relaxed_OU.log", printgen=10) )
monitors = VectorMonitors()
monitors.append( mnModel(filename="rb.log", printgen=10) )
monitors.append( mnFile(filename="rb.trees", printgen=10, timetree) )
monitors.append( mnFile(filename="rb.trees", printgen=10, fbd_tree) )
monitors.append( mnScreen(printgen=100, extant_mrca, diversification) )
monitors.append( mnScreen(printgen=100, origin_time, diversification) )
monitors.append( mnScreen(printgen=100, origin_time, extinction_rate, speciation_rate) )
mymcmc = mcmc(mymodel, monitors, moves, nruns=2, combine="mixed")
mymodel = model(fbd_tree)
mymcmc = mcmc(mymodel, monitors, moves, nruns=2, combine="mixed")
